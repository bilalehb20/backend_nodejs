<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>REST API Documentation</title>
</head>
<body>
    <h1>REST API Documentation</h1>
    <p>Database-driven REST API with Node.js and Express</p>

    <h2>Base URL</h2>
    <p><code>http://localhost:3000/api</code></p>

    <h2>Authentication</h2>
    <p>Some endpoints require authentication. Include the JWT token in the Authorization header:</p>
    <p><code>Authorization: Bearer YOUR_TOKEN_HERE</code></p>

    <h2>Endpoints</h2>

    <h3>Authentication Endpoints</h3>

    <h4>POST /api/auth/register</h4>
    <p><strong>Description:</strong> Register a new user</p>
    <p><strong>Request Body:</strong></p>
    <pre>{
  "firstname": "John",
  "lastname": "Doe",
  "email": "john@example.com",
  "password": "password123"
}</pre>
    <p><strong>Response:</strong></p>
    <pre>{
  "message": "User registered successfully",
  "user": {
    "id": 1,
    "firstname": "John",
    "lastname": "Doe",
    "email": "john@example.com",
    "created_at": "2024-01-01 12:00:00"
  }
}</pre>

    <h4>POST /api/auth/login</h4>
    <p><strong>Description:</strong> Login and receive JWT token</p>
    <p><strong>Request Body:</strong></p>
    <pre>{
  "email": "john@example.com",
  "password": "password123"
}</pre>
    <p><strong>Response:</strong></p>
    <pre>{
  "message": "Login successful",
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "user": {
    "id": 1,
    "firstname": "John",
    "lastname": "Doe",
    "email": "john@example.com"
  }
}</pre>

    <h3>User Endpoints</h3>

    <h4>GET /api/users</h4>
    <p><strong>Description:</strong> Get all users</p>
    <p><strong>Response:</strong></p>
    <pre>[
  {
    "id": 1,
    "firstname": "John",
    "lastname": "Doe",
    "email": "john@example.com",
    "created_at": "2024-01-01 12:00:00"
  }
]</pre>

    <h4>GET /api/users/:id</h4>
    <p><strong>Description:</strong> Get user by ID</p>
    <p><strong>URL Parameters:</strong></p>
    <ul>
        <li><code>id</code> - User ID (required)</li>
    </ul>
    <p><strong>Response:</strong></p>
    <pre>{
  "id": 1,
  "firstname": "John",
  "lastname": "Doe",
  "email": "john@example.com",
  "created_at": "2024-01-01 12:00:00"
}</pre>

    <h4>POST /api/users</h4>
    <p><strong>Description:</strong> Create a new user</p>
    <p><strong>Request Body:</strong></p>
    <pre>{
  "firstname": "John",
  "lastname": "Doe",
  "email": "john@example.com",
  "password": "password123"
}</pre>
    <p><strong>Validation Rules:</strong></p>
    <ul>
        <li>firstname: required, no numbers</li>
        <li>lastname: required, not empty</li>
        <li>email: required, valid email format, unique</li>
        <li>password: required, minimum 8 characters</li>
    </ul>

    <h4>PUT /api/users/:id</h4>
    <p><strong>Description:</strong> Update user by ID</p>
    <p><strong>URL Parameters:</strong></p>
    <ul>
        <li><code>id</code> - User ID (required)</li>
    </ul>
    <p><strong>Request Body:</strong> (all fields optional)</p>
    <pre>{
  "firstname": "Jane",
  "lastname": "Smith",
  "email": "jane@example.com",
  "password": "newpassword123"
}</pre>

    <h4>DELETE /api/users/:id</h4>
    <p><strong>Description:</strong> Delete user by ID</p>
    <p><strong>URL Parameters:</strong></p>
    <ul>
        <li><code>id</code> - User ID (required)</li>
    </ul>
    <p><strong>Response:</strong> 204 No Content</p>

    <h3>Event Endpoints</h3>

    <h4>GET /api/events</h4>
    <p><strong>Description:</strong> Get all events with pagination, search, and sorting</p>
    <p><strong>Query Parameters:</strong></p>
    <ul>
        <li><code>limit</code> - Number of results per page (required, numeric, default: 10)</li>
        <li><code>offset</code> - Number of results to skip (required, numeric, default: 0)</li>
        <li><code>sort</code> - Column to sort by (optional: id, title, start_date, end_date, location, user_id, default: start_date)</li>
        <li><code>order</code> - Sort order (optional: asc, desc, default: asc)</li>
        <li><code>query</code> - Search query to filter by title, description, or location (optional)</li>
    </ul>
    <p><strong>Example:</strong> <code>GET /api/events?limit=5&offset=0&sort=start_date&order=asc&query=concert</code></p>
    <p><strong>Response:</strong></p>
    <pre>{
  "events": [
    {
      "id": 1,
      "title": "Concert",
      "description": "Live music event",
      "start_date": "2024-12-31 20:00:00",
      "end_date": "2025-01-01 02:00:00",
      "location": "Amsterdam Arena",
      "user_id": 1,
      "firstname": "John",
      "lastname": "Doe",
      "user_email": "john@example.com"
    }
  ],
  "pagination": {
    "limit": 5,
    "offset": 0,
    "total": 1
  }
}</pre>

    <h4>GET /api/events/search?query=...</h4>
    <p><strong>Description:</strong> Search events by title, description, or location</p>
    <p><strong>Query Parameters:</strong></p>
    <ul>
        <li><code>query</code> - Search term (required)</li>
    </ul>
    <p><strong>Example:</strong> <code>GET /api/events/search?query=concert</code></p>
    <p><strong>Response:</strong></p>
    <pre>{
  "events": [
    {
      "id": 1,
      "title": "Concert",
      "description": "Live music event",
      "start_date": "2024-12-31 20:00:00",
      "end_date": "2025-01-01 02:00:00",
      "location": "Amsterdam Arena",
      "user_id": 1,
      "firstname": "John",
      "lastname": "Doe",
      "user_email": "john@example.com"
    }
  ],
  "count": 1
}</pre>

    <h4>GET /api/events/:id</h4>
    <p><strong>Description:</strong> Get event by ID</p>
    <p><strong>URL Parameters:</strong></p>
    <ul>
        <li><code>id</code> - Event ID (required)</li>
    </ul>
    <p><strong>Response:</strong></p>
    <pre>{
  "id": 1,
  "title": "Concert",
  "description": "Live music event",
  "start_date": "2024-12-31 20:00:00",
  "end_date": "2025-01-01 02:00:00",
  "location": "Amsterdam Arena",
  "user_id": 1,
  "firstname": "John",
  "lastname": "Doe",
  "user_email": "john@example.com"
}</pre>

    <h4>POST /api/events</h4>
    <p><strong>Description:</strong> Create a new event (Protected - requires authentication)</p>
    <p><strong>Request Body:</strong></p>
    <pre>{
  "title": "Concert",
  "description": "Live music event",
  "start_date": "2024-12-31T20:00:00",
  "end_date": "2025-01-01T02:00:00",
  "location": "Amsterdam Arena",
  "user_id": 1
}</pre>
    <p><strong>Validation Rules:</strong></p>
    <ul>
        <li>title: required, minimum 3 characters</li>
        <li>description: optional</li>
        <li>start_date: required, valid date, cannot be in the past</li>
        <li>end_date: required, valid date, must be after start_date</li>
        <li>location: required, minimum 3 characters</li>
        <li>user_id: required, must exist in users table</li>
    </ul>

    <h4>PUT /api/events/:id</h4>
    <p><strong>Description:</strong> Update event by ID (Protected - requires authentication)</p>
    <p><strong>URL Parameters:</strong></p>
    <ul>
        <li><code>id</code> - Event ID (required)</li>
    </ul>
    <p><strong>Request Body:</strong> (all fields optional)</p>
    <pre>{
  "title": "Updated Concert",
  "description": "Updated description",
  "start_date": "2024-12-31T20:00:00",
  "end_date": "2025-01-01T02:00:00",
  "location": "Updated Location",
  "user_id": 1
}</pre>

    <h4>DELETE /api/events/:id</h4>
    <p><strong>Description:</strong> Delete event by ID (Protected - requires authentication)</p>
    <p><strong>URL Parameters:</strong></p>
    <ul>
        <li><code>id</code> - Event ID (required)</li>
    </ul>
    <p><strong>Response:</strong> 204 No Content</p>

    <h2>Validation Rules Summary</h2>

    <h3>User Validation</h3>
    <ul>
        <li><strong>firstname:</strong> Required, cannot contain numbers</li>
        <li><strong>lastname:</strong> Required, cannot be empty</li>
        <li><strong>email:</strong> Required, must be valid email format, must be unique</li>
        <li><strong>password:</strong> Required, minimum 8 characters</li>
    </ul>

    <h3>Event Validation</h3>
    <ul>
        <li><strong>title:</strong> Required, minimum 3 characters</li>
        <li><strong>description:</strong> Optional</li>
        <li><strong>start_date:</strong> Required, valid date, cannot be in the past</li>
        <li><strong>end_date:</strong> Required, valid date, must be after start_date</li>
        <li><strong>location:</strong> Required, minimum 3 characters</li>
        <li><strong>user_id:</strong> Required, must exist in users table</li>
    </ul>

    <h2>Error Responses</h2>
    <p>All errors follow this format:</p>
    <pre>{
  "error": "Error message"
}</pre>
    <p>Or for validation errors:</p>
    <pre>{
  "errors": [
    "firstname is required",
    "email must be a valid email address"
  ]
}</pre>

    <h2>Status Codes</h2>
    <ul>
        <li><strong>200:</strong> Success</li>
        <li><strong>201:</strong> Created</li>
        <li><strong>204:</strong> No Content (successful deletion)</li>
        <li><strong>400:</strong> Bad Request (validation errors)</li>
        <li><strong>401:</strong> Unauthorized (authentication required)</li>
        <li><strong>403:</strong> Forbidden (invalid token)</li>
        <li><strong>404:</strong> Not Found</li>
        <li><strong>409:</strong> Conflict (duplicate email)</li>
        <li><strong>500:</strong> Internal Server Error</li>
    </ul>
</body>
</html>
